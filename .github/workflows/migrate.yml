name: Migrate
on:
  workflow_dispatch:
    inputs:
      repo_user:
        description: 'Repo Username'
      repo_name:
        description: 'Repo Name'
      mirror:
        description: 'Clone (0) or Mirror (1)'
        default: 0
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Migrate
        id: migrate
        run: |
          git config --global user.email "mmar-migrate@users.noreply.github.com"
          git config --global user.name "mmar-migrate"
          export GIT_USER="${{ secrets.AUTH_NAME }}"
          export GIT_TOKEN="${{ secrets.AUTH_KEY }}"

          [[ "${{ github.event.inputs.mirror }}" -eq 1 ]] && MIRROR="-m"

          ./migrate $MIRROR ${{ github.event.inputs.repo_user }} ${{ github.event.inputs.repo_name }}
